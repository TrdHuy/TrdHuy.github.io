<head>
     <link rel="stylesheet" href="./assets/css/base.css">
     <link rel="stylesheet" href="./assets/css/style.css">
     <link rel="stylesheet" href="./assets/css/portfolio.css">
     <link rel="preconnect" href="https://fonts.googleapis.com">
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
 </head>
 
 <body style="background: var(--eerie-black-2);">
 
     <div id="portfolio-overview-area" class="portfolio-overview-area active">
         <ul class="filter-list">
 
             <li class="filter-item">
                 <button class="active" data-filter-btn>All</button>
             </li>
 
             <li class="filter-item">
                 <button data-filter-btn>Web design</button>
             </li>
 
             <li class="filter-item">
                 <button data-filter-btn>Applications</button>
             </li>
 
             <li class="filter-item">
                 <button data-filter-btn>Web development</button>
             </li>
 
         </ul>
 
         <div class="filter-select-box">
 
             <button class="filter-select" data-select>
 
                 <div class="select-value" data-selecct-value>Select category</div>
 
                 <div class="select-icon">
                     <ion-icon name="chevron-down"></ion-icon>
                 </div>
 
             </button>
 
             <ul class="select-list">
 
                 <li class="select-item">
                     <button data-select-item>All</button>
                 </li>
 
                 <li class="select-item">
                     <button data-select-item>Web design</button>
                 </li>
 
                 <li class="select-item">
                     <button data-select-item>Applications</button>
                 </li>
 
                 <li class="select-item">
                     <button data-select-item>Web development</button>
                 </li>
 
             </ul>
 
         </div>
 
         <ul id="portfolio-list" class="project-list">
             <li class="project-item  active" data-filter-item data-category="web development">
                 <figure class="project-img">
                     <div class="project-item-icon-box">
                         <ion-icon name="eye-outline"></ion-icon>
                     </div>
                     <img src="./assets/images/project-1.jpg" alt="finance" loading="lazy">
                 </figure>
 
                 <h3 class="project-title">Finance</h3>
 
                 <p class="project-category">Web development</p>
             </li>
         </ul>
     </div>
 
 
     <div id="portfolio-page-detai" class="portfolio-page-detai">
         <div class="flex-horizontal-layout" style="align-items: center;">
             <button id="portfolio-close-btn" class="icon-btn">
                 <ion-icon name="chevron-back"></ion-icon>
             </button>
             <div>
                 <h3 id="portfolio-page-title" class="h3">Portfolio</h3>
                 <!-- <p class="underline-for-text"></p> -->
             </div>
         </div>
 
         <iframe id="portfolio-page-iframe-container" allowTransparency="true" scrolling="no" frameborder="0"
             allowfullscreen="true" style="width: 100%; height: auto; margin-top: 30px;"></iframe>
     </div>
 </body>
 
 <footer>
     <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
     <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
     <script src="./assets/js/contract.js"></script>
     <script src="./assets/js/iframeSizeChangeCallback.js"></script>
     <script>
 
         const elementToggleFunc = function (elem) { elem.classList.toggle("active"); }
         // custom select variables
         const select = document.querySelector("[data-select]");
         const selectItems = document.querySelectorAll("[data-select-item]");
         const selectValue = document.querySelector("[data-selecct-value]");
         const filterBtn = document.querySelectorAll("[data-filter-btn]");
 
         select.addEventListener("click", function () { elementToggleFunc(this); });
 
         // add event in all select items
         for (let i = 0; i < selectItems.length; i++) {
             selectItems[i].addEventListener("click", function () {
 
                 let selectedValue = this.innerText.toLowerCase();
                 selectValue.innerText = this.innerText;
                 elementToggleFunc(select);
                 filterFunc(selectedValue);
 
             });
         }
 
         // filter variables
         const filterItems = document.querySelectorAll("[data-filter-item]");
 
         const filterFunc = function (selectedValue) {
 
             for (let i = 0; i < filterItems.length; i++) {
 
                 if (selectedValue === "all") {
                     filterItems[i].classList.add("active");
                 } else if (selectedValue === filterItems[i].dataset.category) {
                     filterItems[i].classList.add("active");
                 } else {
                     filterItems[i].classList.remove("active");
                 }
 
             }
 
         }
 
         // add event in all filter button items for large screen
         let lastClickedBtn = filterBtn[0];
 
         for (let i = 0; i < filterBtn.length; i++) {
 
             filterBtn[i].addEventListener("click", function () {
 
                 let selectedValue = this.innerText.toLowerCase();
                 selectValue.innerText = this.innerText;
                 filterFunc(selectedValue);
 
                 lastClickedBtn.classList.remove("active");
                 this.classList.add("active");
                 lastClickedBtn = this;
 
             });
 
         }
 
 
 
 
 
 
 
 
 
         //#################################################
         const TRD_CONSTRACT = window.TRD_CONSTRACT;
         
         const portfolioOverviewArea = document.getElementById('portfolio-overview-area');
         const projectList = document.getElementById('portfolio-list');
         const portfolioPageTitle = document.getElementById('portfolio-page-title');
         const portfolioCloseBtn = document.getElementById('portfolio-close-btn');
         const portfolioPageDetail = document.getElementById('portfolio-page-detai');
         const portfolioList = document.getElementById('portfolio-list');
         const portfolioIframeContainer = document.getElementById('portfolio-page-iframe-container');
 
         window.addEventListener('message', function (event) {
             const data = event.data;
             switch (data.event) {
                 case TRD_CONSTRACT.EVENT.IFRAME_CONTENT_SIZE_CHANGED:
                     if (data.frameId) {
                         if (event.data.height) {
                             portfolioIframeContainer.style.height = event.data.height + 'px';
                         }
                     }
                     break;
                 default:
                     console.log('Unknown event:', data.event);
             }
         });
 
         portfolioCloseBtn.addEventListener('click', function () {
             portfolioOverviewArea.classList.add('active')
             portfolioPageDetail.classList.remove('active')
             portfolioIframeContainer.setAttribute('src', '')
         })
 
         async function fetchProjects() {
             try {
                 const response = await fetch('data/portfolio/portfolios.json');
                 const projects = await response.json();
                 return projects;
             } catch (error) {
                 console.error('Error fetching projects:', error);
             }
         }
 
         function projectItemClickCallback(project) {
             portfolioOverviewArea.classList.remove('active')
             portfolioPageDetail.classList.add('active')
             portfolioPageTitle.innerText = project.page_name
             portfolioIframeContainer.setAttribute('src', project.page_url + '?iframeId=portfolioIframeContainer')
         }
 
         // Hàm tạo các phần tử HTML từ dữ liệu JSON
         function createProjectList(projects) {
             projects.forEach(project => {
                 const listItem = document.createElement('li');
                 listItem.className = 'project-item active';
                 listItem.setAttribute('data-filter-item', '');
                 listItem.setAttribute('data-category', project.page_category);
 
                 const figure = document.createElement('figure');
                 figure.className = 'project-img';
 
                 const iconBox = document.createElement('div');
                 iconBox.className = 'project-item-icon-box';
                 const icon = document.createElement('ion-icon');
                 icon.setAttribute('name', 'eye-outline');
                 iconBox.appendChild(icon);
                 figure.appendChild(iconBox);
 
                 const img = document.createElement('img');
                 img.src = project.page_avatar;
                 img.alt = project.page_name;
                 img.loading = 'lazy';
                 figure.appendChild(img);
 
                 const title = document.createElement('h3');
                 title.className = 'project-title';
                 title.textContent = project.page_name;
 
                 const category = document.createElement('p');
                 category.className = 'project-category';
                 category.textContent = project.page_category;
 
                 listItem.appendChild(figure);
                 listItem.appendChild(title);
                 listItem.appendChild(category);
                 listItem.addEventListener('click', function () {
                     projectItemClickCallback(project)
                 })
                 projectList.appendChild(listItem);
             });
         }
 
         // Khởi tạo dữ liệu
         async function init() {
             const projects = await fetchProjects();
             if (projects) {
                 createProjectList(projects);
             }
         }
 
         // Gọi hàm khởi tạo
 
         window.addEventListener('load', function () {
             // init();
         })
 
         init()
     </script>
 </footer>